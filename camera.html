<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
	<script src="https://xs673753.xsrv.jp/2D_graphics.js"></script>

	<script>
		function lissajous() {
			let fx0, fy0,len0,fx1,fy1,len1, rot, num_dot, tick, theta, p, sp;
            len0 = parseFloat(document.getElementById("len0").value);
	    fx0 = parseFloat(document.getElementById("fx0").value);
            fy0 = parseFloat(document.getElementById("fy0").value);
            len1 = parseFloat(document.getElementById("len1").value);
            fx1 = parseFloat(document.getElementById("fx1").value);
            fy1 = parseFloat(document.getElementById("fy1").value);
            rot = parseFloat(document.getElementById("rot").value);
	    	num_dot=parseFloat(document.getElementById("num_dot").value);
			set_coordinate(0, 0,2.6875*(len0+len1), 0);
			tick = Math.PI * 2.0;
			for (i = 0; i < num_dot; i++) {
				theta = i*rot / num_dot;
                p = new point(len0 * diaCos(theta * fx0) + len1 * diaCos(theta * fx1), len0 * diaSin(theta * fy0) + len1 * diaSin(theta * fy1));
				//console.log(theta+","+diaSin(theta)+","+diaCos(theta));
				sp = screen_point(p);
				draw_pixel(sp.x+X_size/4, sp.y,`hsl(${360 *i/num_dot},100%, 50%)`);
				p = new point(len0 * Math.cos(theta*tick * fx0) + len1*Math.cos(theta *tick* fx1), len0 * Math.sin(theta*tick * fy0) + len1 * Math.sin(theta*tick * fy1))
				sp=screen_point(p);
				draw_pixel(sp.x-X_size/4, sp.y,`hsl(${360 *i/num_dot},100%, 50%)`);
            }
		}
		function diaSin(num) {
			var i = (num - Math.floor(num)) * 4;
			var j = i - Math.floor(i);
			if (i < 1) return j;
			else if (i < 2) return 1 - j;
			else if (i < 3) return - j;
			else return -1 + j;
		}
        function diaCos(num) {
			return diaSin(num+0.25);
        }
	</script>
</head>

<body>
	<canvas id="canvas" width="1080" height="720"></canvas>
	<form>
		<input type="button" value="draw" onclick="clear_canvas();lissajous();">
		<input type="button" value="png画像作成" onclick="canvas_to_png(`png_image`);">
		len0:<input id="len0" type="number" value="1" />
		fx0:<input id="fx0" type="number" value="1" />
		fy0:<input id="fy0" type="number" value="1" />
		len1:<input id="len1" type="number" value="1" />
		fx1:<input id="fx1" type="number" value="1" />
		fy1:<input id="fy1" type="number" value="1" />
		rot:<input id="rot" type="number" value="1" />
		num_dot:<input id="num_dot" type="number" value="100000" />
	</form>

	<br>
	<img id="png_image">
</body>
</html>

